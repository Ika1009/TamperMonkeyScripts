// ==UserScript==
// @name         Find Free Spots
// @namespace    http://tampermonkey.net/
// @version      1.6
// @description  Find all of the available space on the UK gov website when found
// @author       You
// @match        https://driver-services.dvsa.gov.uk/*
// @icon         data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==
// @grant        none
// @license      MIT
// ==/UserScript==

(async function() {
    'use strict';

    // change this to change the time between searches, it is in seconds
    const timeBetweenSearchesInSeconds = 7; // <-----
    // ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

    const _0xc41cfb=_0x1e92;(function(_0x299100,_0x50160a){const _0x1a37f9=_0x1e92,_0x3c2aeb=_0x299100();while(!![]){try{const _0x455999=parseInt(_0x1a37f9(0x1b8))/0x1+parseInt(_0x1a37f9(0x1d0))/0x2+-parseInt(_0x1a37f9(0x1bd))/0x3*(-parseInt(_0x1a37f9(0x1cb))/0x4)+parseInt(_0x1a37f9(0x1ab))/0x5+parseInt(_0x1a37f9(0x1ca))/0x6*(parseInt(_0x1a37f9(0x1c9))/0x7)+-parseInt(_0x1a37f9(0x1c6))/0x8*(parseInt(_0x1a37f9(0x1b5))/0x9)+-parseInt(_0x1a37f9(0x1bf))/0xa;if(_0x455999===_0x50160a)break;else _0x3c2aeb['push'](_0x3c2aeb['shift']());}catch(_0x4f7154){_0x3c2aeb['push'](_0x3c2aeb['shift']());}}}(_0x5e16,0xbb6f2));if(localStorage[_0xc41cfb(0x1cd)]('auth')!==_0xc41cfb(0x1b2)){console[_0xc41cfb(0x1c2)](_0xc41cfb(0x1c1));return;}function _0x1e92(_0x3b170a,_0x1477bb){const _0x5e16b2=_0x5e16();return _0x1e92=function(_0x1e9267,_0x5885f1){_0x1e9267=_0x1e9267-0x1a4;let _0x18bc40=_0x5e16b2[_0x1e9267];return _0x18bc40;},_0x1e92(_0x3b170a,_0x1477bb);}const timeBetweenSearchesInMiliSeconds=timeBetweenSearchesInSeconds*0x3e8,table=document[_0xc41cfb(0x1c7)]('browseslots');function _0x5e16(){const _0x5912cb=['finding...','Not\x20validated.\x20Contact\x20the\x20owner\x20of\x20the\x20script...','log','searchForWeeklySlotsPreviousWeek','October','getElementsByClassName','480mqRBIn','getElementById','getDate','4249HvUxma','6306kjBYdD','83320gQtCpO','trim','getItem','textContent','July','2043540ModXbS','click','indexOf','April','March','innerText','querySelector','June','tbody','Is\x20it\x20more\x20than\x202\x20months:\x20','6282440ZvpYza','includes','getFullYear','May','length','Clicked\x20anchor\x20with\x20max\x20number\x20','August','allowed','December','match','178920PdHktS','Button\x20clicked!','forEach','115660pIznph','\x200\x20','querySelectorAll','February','split','63zyluRh','getMonth','15087750SRQuXp'];_0x5e16=function(){return _0x5912cb;};return _0x5e16();}if(table){function delay(_0x4766d7){return new Promise(_0x40a2c4=>setTimeout(_0x40a2c4,_0x4766d7));}console[_0xc41cfb(0x1c2)](_0xc41cfb(0x1c0)),await delay(0xbb8),await FindAvailableSpots();async function FindAvailableSpots(){const _0x40ea88=_0xc41cfb;CloseWarningPopup();let _0x33a8c6=document[_0x40ea88(0x1c5)]('centre\x20bold')[0x0][_0x40ea88(0x1a6)];console[_0x40ea88(0x1c2)](_0x40ea88(0x1aa)+isMoreThanTwoMonthsFromToday(_0x33a8c6));if(isMoreThanTwoMonthsFromToday(_0x33a8c6)){await VratiSeUnazad();return;}const _0x1c0b2c=document[_0x40ea88(0x1c7)]('browseslots');let _0x21c040=_0x1c0b2c[_0x40ea88(0x1a7)](_0x40ea88(0x1a9))[_0x40ea88(0x1ba)]('tr'),_0x57ca74=0x0,_0x5c69c5=null;_0x21c040[_0x40ea88(0x1b7)](_0x4ae2c6=>{const _0x4ade83=_0x40ea88,_0x37e5d8=_0x4ae2c6[_0x4ade83(0x1ba)]('td');for(let _0x507e4a=0x1;_0x507e4a<_0x37e5d8[_0x4ade83(0x1af)]-0x1;_0x507e4a++){const _0x313771=_0x37e5d8[_0x507e4a][_0x4ade83(0x1a7)]('a'),_0x1c8013=_0x313771[_0x4ade83(0x1ce)][_0x4ade83(0x1cc)](),_0x1c3fb3=_0x1c8013[_0x4ade83(0x1b4)](/\d+/);if(_0x1c3fb3){const _0x5af94f=parseInt(_0x1c3fb3[0x0],0xa);_0x5af94f>_0x57ca74&&!_0x1c8013[_0x4ade83(0x1ac)](_0x4ade83(0x1b9))&&(_0x57ca74=_0x5af94f,_0x5c69c5=_0x313771);}}}),_0x5c69c5&&(_0x5c69c5[_0x40ea88(0x1d1)](),console[_0x40ea88(0x1c2)](_0x40ea88(0x1b0)+_0x57ca74)),await NextWeek();}function CloseWarningPopup(){const _0x522ec2=_0xc41cfb,_0x59df3d=document[_0x522ec2(0x1c7)]('backButtonCloseDialog');_0x59df3d&&(_0x59df3d[_0x522ec2(0x1d1)](),console[_0x522ec2(0x1c2)](_0x522ec2(0x1b6)));}async function VratiSeUnazad(){const _0x1a498a=_0xc41cfb;await delay(timeBetweenSearchesInMiliSeconds),CloseWarningPopup();const _0xb0a2af=document[_0x1a498a(0x1c7)](_0x1a498a(0x1c3));if(_0xb0a2af)_0xb0a2af[_0x1a498a(0x1d1)](),await VratiSeUnazad();else await FindAvailableSpots();}async function NextWeek(){const _0x1deb33=_0xc41cfb;await delay(timeBetweenSearchesInMiliSeconds);let _0x37dba4=document[_0x1deb33(0x1c7)]('searchForWeeklySlotsNextAvailable');if(_0x37dba4)_0x37dba4[_0x1deb33(0x1d1)]();await delay(0x3e8),await FindAvailableSpots();}function isMoreThanTwoMonthsFromToday(_0x577393){const _0x1ad2a8=_0xc41cfb;let _0x4bb186=_0x577393[_0x1ad2a8(0x1bc)]('â€“')[0x0][_0x1ad2a8(0x1cc)](),_0x182850=_0x4bb186['split']('\x20')[0x0]['replace'](/\D/g,''),_0x8ae2f3=_0x4bb186[_0x1ad2a8(0x1bc)]('\x20')[0x1],_0x2e91b5=_0x4bb186['split']('\x20')[0x2],_0x1c1415=new Date(),_0x14b7d0=['January',_0x1ad2a8(0x1bb),_0x1ad2a8(0x1a5),_0x1ad2a8(0x1a4),_0x1ad2a8(0x1ae),_0x1ad2a8(0x1a8),_0x1ad2a8(0x1cf),_0x1ad2a8(0x1b1),'September',_0x1ad2a8(0x1c4),'November',_0x1ad2a8(0x1b3)],_0x5e6b6b=_0x14b7d0[_0x1ad2a8(0x1d2)](_0x8ae2f3),_0x30c72d=new Date(_0x2e91b5,_0x5e6b6b,_0x182850),_0x591b98=(_0x30c72d['getFullYear']()-_0x1c1415[_0x1ad2a8(0x1ad)]())*0xc+_0x30c72d[_0x1ad2a8(0x1be)]()-_0x1c1415[_0x1ad2a8(0x1be)]();return _0x591b98>0x2||_0x591b98===0x2&&_0x1c1415[_0x1ad2a8(0x1c8)]()<_0x30c72d['getDate']();}}

})();